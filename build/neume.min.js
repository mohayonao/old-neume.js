!function t(e,n,i){function r(u,s){if(!n[u]){if(!e[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};e[u][0].call(l.exports,function(t){var n=e[u][1][t];return r(n?n:t)},l,l.exports,t,e,n,i)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<i.length;u++)r(i[u]);return r}({1:[function(t,e){"use strict";var n=t("./src/");n.use(t("./src/ugen/")),"undefined"!=typeof window&&(window.neume=n),e.exports=n},{"./src/":20,"./src/ugen/":39}],2:[function(t,e){"use strict";function n(t,e){r.call(this),this.context=t,this.outlet=null,this._node=i.defaults(e,null)}var i=t("../util"),r=t("../util/emitter"),o=t("../namespace");i.inherits(n,r),n.$$name="NeuComponent",n.prototype.mul=function(t){return new o.Mul(this.context,i.defaults(this._node,this),i.defaults(t,1))},n.prototype.add=function(t){return new o.Sum(this.context,[i.defaults(this._node,this),i.defaults(t,0)])},n.prototype.toAudioNode=function(){return null===this.outlet&&(this.outlet=this.context.toAudioNode(i.defaults(this._node,this))),this.outlet},n.prototype.connect=function(t){return this.context.connect(i.defaults(this._node,this),t),this},n.prototype.disconnect=function(){return this.context.disconnect(i.defaults(this._node,this)),this},e.exports=o.Component=n},{"../namespace":21,"../util":54,"../util/emitter":52}],3:[function(t,e){"use strict";function n(t,e){return e=o.finite(e),t.$$neuDC=t.$$neuDC||{},t.$$neuDC[e]?t.$$neuDC[e]:(t.$$neuDC[e]=this,u.Component.call(this,t),this._value=e,this._bufSrc=null,void(this._state=c))}function i(t,e){for(var n=new Float32Array(t),i=0;t>i;i++)n[i]=e;return n}var r=t("../const"),o=t("../util"),u=t("../namespace");t("./component");var s=new i(r.DC_BUF_SIZE,0),a=new i(r.DC_BUF_SIZE,1),c=0,l=1,f=2;o.inherits(n,u.Component),n.$$name="NeuDC",n.prototype.toAudioNode=function(){if(null===this.outlet){var t,e,i,o=this.context,u=this._value;0===u||1===u?(t=o.createBuffer(1,r.DC_BUF_SIZE,o.sampleRate),t.getChannelData(0).set(u?a:s),e=o.createBufferSource(),e.buffer=t,e.loop=!0,e.start(0),this._bufSrc=e,this._state=l,this.outlet=e):(e=new n(o,1).toAudioNode(),i=o.createGain(),i.gain.value=u,e.connect(i),this.outlet=i)}return this.outlet},n.prototype.connect=function(t){return t instanceof u.webaudio.AudioParam?t.value=this._value:this.context.connect(this.toAudioNode(),t),this},n.prototype.disconnect=function(){return this.stop(this.context.currentTime),this.context.disconnect(this.outlet),this},n.prototype.stop=function(t){return this._state===l&&(this._bufSrc.stop(o.finite(t)),this._state=f),this},n.prototype.valueOf=function(){return this._value},e.exports=u.DC=n},{"../const":8,"../namespace":21,"../util":54,"./component":2}],4:[function(t){t("./component"),t("./dc"),t("./mul"),t("./param"),t("./sum")},{"./component":2,"./dc":3,"./mul":5,"./param":6,"./sum":7}],5:[function(t,e){"use strict";function n(t,e,n){if(e=e.valueOf(),n=n.valueOf(),"number"==typeof e&&"number"==typeof n)return new r.DC(t,e*n);if(r.Component.call(this,t),"number"==typeof e){var i=e;e=n,n=i}return 0===n?new r.DC(t,0):1===n?new r.Component(t,e):(this._a=e,void(this._b=n))}var i=t("../util"),r=t("../namespace");t("./component"),i.inherits(n,r.Component),n.$$name="NeuMul",n.prototype.mul=function(t){return t=t.valueOf(),"number"==typeof this._b&&"number"==typeof t?new r.Mul(this.context,this._a,i.finite(this._b*t)):new r.Mul(this.context,this.toAudioNode(),t)},n.prototype.toAudioNode=function(){return null===this.outlet&&(this.outlet=this.context.createGain(),this.outlet.gain.value=0,this.context.connect(this._a,this.outlet),this.context.connect(this._b,this.outlet.gain)),this.outlet},n.prototype.connect=function(t){return this.context.connect(this.toAudioNode(),t),this},n.prototype.disconnect=function(){return this.context.disconnect(this.outlet),this},e.exports=r.Mul=n},{"../namespace":21,"../util":54,"./component":2}],6:[function(t,e){"use strict";function n(t,e,n){n=n||{},l.Component.call(this,t),this._value=c.finite(e),this._params=[],this._events=[],this._curve=n.curve,this._lag=c.defaults(n.lag,0),this._scheduled=null}function i(t,e,n){var i=t._scheduled;null==i||i.time<=n||(t.cancelScheduledValues(i.time),t[i.method](e,n))}function r(t,e){var n,i,r=e.time,o=t._events,u=0;for(n=0,i=o.length;i>n;++n){if(o[n].time===r&&o[n].type===e.type){u=1;break}if(o[n].time>r)break}o.splice(n,u,e)}function o(t,e,n,i,r,o){var u=(i-r)/(o-r);return(1-u)*e+u*n}function u(t,e,n,i,r,o){var u=(i-r)/(o-r);return e>0&&n>0?e*Math.pow(n/e,u):t}function s(t,e,n,i,r){return e+(t-e)*Math.exp((i-n)/r)}function a(t,e,n,i,r){var o=(e-n)/(i-n);return 0>=o?c.defaults(r[0],t):o>=1?c.defaults(r[r.length-1],t):c.defaults(r[r.length*o|0],t)}var c=t("../util"),l=t("../namespace");t("./component"),c.inherits(n,l.Component),n.$$name="NeuParam",Object.defineProperties(n.prototype,{events:{get:function(){return this._events.slice()},enumerable:!0},value:{set:function(t){t=c.finite(t);var e=this._params;this._value=t;for(var n=0,i=e.length;i>n;n++)e[n].value=t},get:function(){return this._params.length?this._params[0].value:this._value},enumerable:!0}}),n.prototype.valueAtTime=function(t){t=c.finite(this.context.toSeconds(t));for(var e,n=this._value,i=this._events,r=0;r<i.length;r++){var l=i[r],f=i[r+1];if(t<l.time)break;if(e=Math.min(t,f?f.time:t),f&&"LinearRampToValue"===f.type)n=o(n,l.value,f.value,e,l.time,f.time);else if(f&&"ExponentialRampToValue"===f.type)n=u(n,l.value,f.value,e,l.time,f.time);else switch(l.type){case"SetValue":case"LinearRampToValue":case"ExponentialRampToValue":n=l.value;break;case"SetTarget":n=s(n,l.value,e,l.time,l.timeConstant);break;case"SetValueCurve":n=a(n,e,l.time,l.time+l.duration,l.curve)}}return n},n.prototype.setAt=function(t,e){t=c.finite(t),e=c.finite(this.context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].setValueAtTime(t,e);return r(this,{type:"SetValue",value:t,time:e}),this},n.prototype.setValueAtTime=n.prototype.setAt,n.prototype.linTo=function(t,e){t=c.finite(t),e=c.finite(this.context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].linearRampToValueAtTime(t,e);return r(this,{type:"LinearRampToValue",value:t,time:e}),this},n.prototype.linearRampToValueAtTime=n.prototype.linTo,n.prototype.expTo=function(t,e){t=c.finite(t),e=c.finite(this.context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].exponentialRampToValueAtTime(t,e);return r(this,{type:"ExponentialRampToValue",value:t,time:e}),this},n.prototype.exponentialRampToValueAtTime=n.prototype.expTo,n.prototype.targetAt=function(t,e,n){t=c.finite(t),e=c.finite(this.context.toSeconds(e)),n=c.finite(this.context.toSeconds(n));for(var i=this._params,o=0,u=i.length;u>o;o++)i[o].setTargetAtTime(t,e,n);return r(this,{type:"SetTarget",value:t,time:e,timeConstant:n}),this},n.prototype.setTargetAtTime=n.prototype.targetAt,n.prototype.curveAt=function(t,e,n){e=c.finite(this.context.toSeconds(e)),n=c.finite(this.context.toSeconds(n));for(var i=this._params,o=0,u=i.length;u>o;o++)i[o].setValueCurveAtTime(t,e,n);return r(this,{type:"SetValueCurve",time:e,duration:n,curve:t}),this},n.prototype.setValueCurveAtTime=n.prototype.curveAt,n.prototype.cancel=function(t){t=c.finite(this.context.toSeconds(t));var e,n,i=this._params,r=this._events;for(e=0,n=i.length;n>e;e++)i[e].cancelScheduledValues(t);for(e=0,n=r.length;n>e;++e)if(r[e].time>=t){r.splice(e);break}return this},n.prototype.cancelScheduledValues=n.prototype.cancel,n.prototype.update=function(t,e,n){var r=this.context,o=e+c.finite(r.toSeconds(c.defaults(n,this._lag,0))),u=this.valueAtTime(e),s=this._curve,a=null;switch(i(this,u,e),e>=o&&(s="step"),s){case"exp":case"exponential":this.setValueAtTime(Math.max(1e-6,u),e),this.exponentialRampToValueAtTime(Math.max(1e-6,t),o),a={method:"exponentialRampToValueAtTime",time:o};break;case"lin":case"linear":this.setValueAtTime(u,e),this.linearRampToValueAtTime(t,o),a={method:"linearRampToValueAtTime",time:o};break;default:this.setValueAtTime(t,e)}return this._scheduled=a,this},n.prototype.toAudioNode=function(t){var e=this.context;return null==this.outlet&&(this.outlet=e.createGain(),this.outlet.gain.value=this._value,this._params.push(this.outlet.gain),t?e.connect(t,this.outlet):e.connect(new l.DC(e,1),this.outlet)),this.outlet},n.prototype.connect=function(t){return t instanceof l.webaudio.AudioParam?(t.value=this._value,this._params.push(t)):this.context.connect(this.toAudioNode(),t),this},n.prototype.disconnect=function(){return this.context.disconnect(this.outlet),this},e.exports=l.Param=n},{"../namespace":21,"../util":54,"./component":2}],7:[function(t,e){"use strict";function n(t,e){r.Component.call(this,t);var n=0,o=!1,u=null,s=[];e=i.flatten(e);for(var a=0,c=e.length;c>a;a++){var l=e[a].valueOf();"number"==typeof l?(n+=i.finite(l),o=!0):!u&&l instanceof r.Param?u=l:s.push(l)}return 0===s.length?u?u:new r.DC(t,n):0===n&&null===u&&1===s.length?new r.Component(t,s[0]):(this._hasNumber=o,this._number=n,this._param=u,this._nodes=s,void(this._inputs=e))}var i=t("../util"),r=t("../namespace");t("./component"),i.inherits(n,r.Component),n.$$name="NeuSum",n.prototype.add=function(t){return new r.Sum(this.context,this._inputs.concat(t))},n.prototype.toAudioNode=function(){if(null===this.outlet){for(var t=this.context,e=this._nodes,n=t.createGain(),i=0,r=e.length;r>i;i++)t.connect(e[i],n);this._param&&t.connect(this._param,n),this._number&&t.connect(this._number,n),this.outlet=n}return this.outlet},n.prototype.connect=function(t){for(var e=this.context,n=this._number,i=this._param,o=this._nodes,u=0,s=o.length;s>u;u++)e.connect(e.toAudioNode(o[u]),t);return i?(e.connect(i,t),0!==n&&e.connect(new r.DC(e,n).toAudioNode(),t)):0!==n&&e.connect(n,t),this},n.prototype.disconnect=function(){return this.context.disconnect(this._inputs),this},e.exports=r.Sum=n},{"../namespace":21,"../util":54,"./component":2}],8:[function(t,e){"use strict";e.exports={PROCESS_BUF_SIZE:1024,DC_BUF_SIZE:128,WS_CURVE_SIZE:4096,MAX_RENDERING_SEC:180,MAX_DELAY_SEC:180,AUDIO_BUS_CHANNELS:1023,DEFAULT_MAX_NODES_OF_BUS:64}},{}],9:[function(t,e){"use strict";function n(t,e){this.context=t,this.index=e,this.outlet=t.createGain(),this._maxNodes=i.DEFAULT_MAX_NODES_OF_BUS,this._inputs=[],Object.defineProperties(this,{maxNodes:{set:function(t){this._maxNodes=Math.max(0,r.int(t))},get:function(){return this._maxNodes}},nodes:{get:function(){return this._inputs.slice()}}})}var i=t("../const"),r=t("../util"),o=t("../namespace");n.$$name="NeuAudioBus",n.prototype.append=function(t){return this.context.connect(t.toAudioNode(this.index),this.outlet),this._inputs.push(t),this._maxNodes<this._inputs.length&&this._inputs.shift().stop(),this},n.prototype.remove=function(t){var e=this._inputs.indexOf(t);return-1!==e&&this._inputs.splice(e,1),this},n.prototype.toAudioNode=function(){return this.outlet},e.exports=o.AudioBus=n},{"../const":8,"../namespace":21,"../util":54}],10:[function(t,e){"use strict";function n(t,e){this.context=t,this.sampleRate=e.sampleRate,this.length=e.length,this.duration=e.duration,this.numberOfChannels=e.numberOfChannels,this._buffer=e;for(var n=0;n<this._buffer.numberOfChannels;n++)Object.defineProperty(this,n,{value:this._buffer.getChannelData(n)})}function i(t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="arraybuffer",i.onload=function(){e(i.response)},i.onerror=function(){n({})},i.send()})}function r(t,e){return new Promise(function(n,i){t.decodeAudioData(e,function(t){n(t)},function(){i({})})})}function o(t){var e=u(t);if(0!==e)for(var n=1/e,i=0,r=t.length;r>i;++i)t[i]*=n;return t}function u(t){for(var e=0,n=0,i=t.length;i>n;++n){var r=Math.abs(t[n]);r>e&&(e=r)}return e}function s(t,e,n){return t.length===e?new Float32Array(t):n?c(t,e):a(t,e)}function a(t,e){for(var n=(t.length-1)/(e-1),i=new Float32Array(e),r=0;e>r;r++)i[r]=t[Math.round(r*n)];return i}function c(t,e){for(var n=(t.length-1)/(e-1),i=new Float32Array(e),r=t.length-1,o=0;e>o;o++){var u=o*n,s=0|u,a=Math.min(s+1,r);i[o]=t[s]+Math.abs(u-s)*(t[a]-t[s])}return i}var l=t("../util"),f=t("../namespace"),h=t("../util/fft");n.$$name="NeuBuffer",n.create=function(t,e,i,r){return e=l.int(l.defaults(e,1)),i=l.int(l.defaults(i,0)),r=l.int(l.defaults(r,t.sampleRate)),new n(t,t.createBuffer(e,i,r))},n.from=function(t){for(var e=l.toArray(arguments).slice(1),i=e.length,r=e.reduce(function(t,e){return Math.max(t,e.length)},0),o=t.createBuffer(i,r,t.sampleRate),u=0;i>u;u++)o.getChannelData(u).set(e[u]);return new n(t,o)},n.load=function(t,e){return new Promise(function(o,u){i(e).then(function(e){return r(t,e)}).then(function(e){o(new n(t,e))}).catch(function(t){u(t)})})},n.prototype.getChannelData=function(t){return t=l.clip(l.int(t),0,this.numberOfChannels-1),this._buffer.getChannelData(t)},n.prototype.concat=function(){var t=l.toArray(arguments).filter(function(t){return t instanceof n&&this.numberOfChannels===t.numberOfChannels},this),e=this.numberOfChannels,i=t.reduce(function(t,e){return t+e.length},this.length),r=this.sampleRate,o=this.context.createBuffer(e,i,r);t.unshift(this);for(var u=t.length,s=0;e>s;s++)for(var a=o.getChannelData(s),c=0,f=0;u>f;f++)a.set(t[f][s],c),c+=t[f].length;return new n(this.context,o)},n.prototype.reverse=function(){for(var t=this.numberOfChannels,e=this.context.createBuffer(t,this.length,this.sampleRate),i=0;t>i;i++)e.getChannelData(i).set(l.toArray(this[i]).reverse());return new n(this.context,e)},n.prototype.slice=function(t,e){t=l.int(l.defaults(t,0)),e=l.int(l.defaults(e,this.length)),0>t?t+=this.length:t=Math.min(t,this.length),0>e?e+=this.length:e=Math.min(e,this.length);var i=this.numberOfChannels,r=e-t,o=this.sampleRate,u=null;if(0>=r)u=this.context.createBuffer(i,1,o);else{u=this.context.createBuffer(i,r,o);for(var s=0;i>s;s++)u.getChannelData(s).set(this[s].subarray(t,e))}return new n(this.context,u)},n.prototype.split=function(t){if(t=l.int(l.defaults(t,2)),0>=t)return[];for(var e=new Array(t),n=this.length/t,i=0,r=0,o=0;t>o;o++)r=Math.round(i+n),e[o]=this.slice(i,r),i=r;return e},n.prototype.normalize=function(){for(var t=this.numberOfChannels,e=this.context.createBuffer(t,this.length,this.sampleRate),i=0;t>i;i++)e.getChannelData(i).set(o(this[i]));return new n(this.context,e)},n.prototype.resample=function(t,e){t=Math.max(0,l.int(l.defaults(t,this.length))),e=!!l.defaults(e,!0);for(var i=this.numberOfChannels,r=this.context.createBuffer(i,t,this.sampleRate),o=0;i>o;o++)r.getChannelData(o).set(s(this[o],t,e));return new n(this.context,r)},n.prototype.toAudioBuffer=function(){return this._buffer},n.prototype.toPeriodicWave=function(t){t=l.clip(l.int(t),0,this.numberOfChannels-1);var e=this._buffer.getChannelData(t);4096<e.length&&(e=e.subarray(0,4096));var n=h.forward(e);return this.context.createPeriodicWave(n.real,n.imag)},e.exports=f.Buffer=n},{"../namespace":21,"../util":54,"../util/fft":53}],11:[function(t){t("./audio-bus"),t("./buffer"),t("./interval"),t("./sched"),t("./timeout")},{"./audio-bus":9,"./buffer":10,"./interval":12,"./sched":13,"./timeout":14}],12:[function(t,e){"use strict";function n(t,e,n){var o=1/t.sampleRate,u={next:function(){var n=Math.max(o,i.finite(t.toSeconds(e)));return{value:n,done:!1}}};r.Sched.call(this,t,u),this.on("start",n).on("sched",n)}var i=t("../util"),r=t("../namespace");t("./sched"),i.inherits(n,r.Sched),n.$$name="NeuInterval",e.exports=r.Interval=n},{"../namespace":21,"../util":54,"./sched":13}],13:[function(t,e){"use strict";function n(t,e,n){u.call(this),this.context=t,this._schedIter=e,this._state=s,this._count=0,Object.defineProperties(this,{state:{get:function(){return["UNSCHEDULED","SCHEDULED","PLAYING","PLAYING","FINISHED"][this._state]},enumerable:!0}}),this.on("start",n).on("sched",n).on("stop",n)}function i(t,e,n){if(t._state===c){var o=t.context,u=n?"stop":t._count?"sched":"start",s=t._schedIter.next(),a=n?0:r.finite(o.toSeconds(s.value));t.emit(u,{type:u,playbackTime:e,duration:a,count:t._count++,done:n}),n?t._state=l:o.sched(e+a,function(e){i(t,e,s.done)})}}var r=t("../util"),o=t("../namespace"),u=t("../util/emitter"),s=0,a=1,c=2,l=4;r.inherits(n,u),n.$$name="NeuSched",n.prototype.start=function(t){if(this._state!==s)return this;var e=this.context;return t=r.defaults(e.toSeconds(t),e.currentTime),t=r.finite(t),this._state=a,e.sched(t,function(t){this._state=c,i(this,t,!1)},this),e.start(),this},n.prototype.stop=function(t){if(this._state!==c&&this._state!==a)return this;var e=this.context;return t=r.defaults(e.toSeconds(t),e.currentTime),t=r.finite(t),e.sched(t,function(t){this.emit("stop",{type:"stop",playbackTime:t,duration:0,count:this._count,done:!1}),this._state=l},this),this},e.exports=o.Sched=n},{"../namespace":21,"../util":54,"../util/emitter":52}],14:[function(t,e){"use strict";function n(t,e,n){var o={next:function(){var n=i.finite(t.toSeconds(e));return{value:n,done:!0}}};r.Sched.call(this,t,o),this.on("stop",n)}var i=t("../util"),r=t("../namespace");t("./sched"),i.inherits(n,r.Sched),n.$$name="NeuTimeout",e.exports=r.Timeout=n},{"../namespace":21,"../util":54,"./sched":13}],15:[function(t,e){"use strict";function n(t,e){e=e||{},this.context=this,this.destination=t,this.audioContext=t.context,this.sampleRate=this.audioContext.sampleRate,this.listener=this.audioContext.listener,this.analyser=this.audioContext.createAnalyser(),this._transport=new o.Transport(this,e),this._nodes=[],this._audioBuses=[],this.$$neuDC=null,this.connect(this.analyser,this.destination),Object.defineProperties(this,{currentTime:{get:function(){return this._transport.currentTime},enumerable:!0},bpm:{get:function(){return this._transport.bpm},set:function(t){this._transport.bpm=t},enumerable:!0}}),this.reset()}var i=t("../const"),r=t("../util"),o=t("../namespace");t("./transport");var u=0,s=1,a=2;n.$$name="NeuContext",["createBuffer","decodeAudioData","createPeriodicWave","startRendering"].forEach(function(t){var e=o.webaudio.AudioContext.prototype[t];n.prototype[t]=function(){return e.apply(this.audioContext,arguments)}}),["createBufferSource","createMediaElementSource","createMediaStreamSource","createMediaStreamDestination","createGain","createDelay","createBiquadFilter","createWaveShaper","createPanner","createConvolver","createDynamicsCompressor","createAnalyser","createScriptProcessor","createOscillator","createChannelSplitter","createChannelMerger"].forEach(function(t){var e=o.webaudio.AudioContext.prototype[t];n.prototype[t]=function(){var t=e.apply(this.audioContext,arguments);return this._nodes.push(t),t}}),n.prototype.getAudioBus=function(t){return t=r.clip(r.int(r.defaults(t,0)),0,i.AUDIO_BUS_CHANNELS),this._audioBuses[t]||(this._audioBuses[t]=new o.AudioBus(this,t)),this._audioBuses[t]},n.prototype.start=function(){return this._state===u&&(this._state=s,this._transport.start(),this.connect(this.getAudioBus(0).outlet,this.analyser)),this},n.prototype.stop=function(){return this._state===s&&(this._state=a,this._transport.stop()),this},n.prototype.reset=function(){return this.dispose(),this._audioBuses=[],this._transport.reset(),this._state=u,this},n.prototype.dispose=function(){if(this.$$neuDC){var t=this.$$neuDC,e=this.currentTime;Object.keys(t).forEach(function(n){t[n].stop(e)}),this.$$neuDC=null}return this._nodes.splice(0).forEach(function(t){t.disconnect()}),this},n.prototype.sched=function(t,e,n){return this._transport.sched(t,e,n)},n.prototype.unsched=function(t){return this._transport.unsched(t)},n.prototype.nextTick=function(t,e){return this._transport.nextTick(t,e),this},n.prototype.toAudioNode=function(t){return t&&t.toAudioNode?t=t.toAudioNode():"number"==typeof t&&(t=new o.DC(this,t).toAudioNode()),t instanceof o.webaudio.AudioNode||(t=null),t},n.prototype.toAudioBuffer=function(t){return t&&t.toAudioBuffer?t.toAudioBuffer():(t instanceof o.webaudio.AudioBuffer||(t=null),t)},n.prototype.connect=function(t,e){return e&&(Array.isArray(t)?t.length&&new o.Sum(this,t).connect(e):t instanceof o.Component||t instanceof o.UGen?t.connect(e):e instanceof o.webaudio.AudioParam?"number"==typeof t?e.value=r.finite(t):(t=this.toAudioNode(t),t&&t.connect(e)):e instanceof o.webaudio.AudioNode&&(t=this.toAudioNode(t),t&&t.connect(e)),e.onconnected&&e.onconnected(t)),this},n.prototype.disconnect=function(t){return t&&("function"==typeof t.disconnect?t.disconnect():Array.isArray(t)&&t.forEach(function(t){this.disconnect(t)},this)),this},n.prototype.toSeconds=function(t){return this._transport.toSeconds(t)},e.exports=o.Context=n},{"../const":8,"../namespace":21,"../util":54,"./transport":19}],16:[function(t,e){(function(n){"use strict";function i(t){return Object.defineProperties({},{context:{value:t,enumerable:!0},audioContext:{value:t.audioContext,enumerable:!0},sampleRate:{value:t.sampleRate,enumerable:!0},destination:{value:t.destination,enumerable:!0},currentTime:{get:function(){return t.currentTime},enumerable:!0},bpm:{get:function(){return t.bpm},set:function(e){t.bpm=e},enumerable:!0},toSeconds:{value:t.toSeconds.bind(t),enumerable:!0},Synth:{value:function(e){return new o.Synth(t,e,r.toArray(arguments).slice(1))},enumerable:!0},Buffer:{value:Object.defineProperties(function(e,n,i){return o.Buffer.create(t,e,n,i)},{from:{value:function(e){return o.Buffer.from(t,e)},enumerable:!0},load:{value:function(e){return o.Buffer.load(t,e)},enumerable:!0}}),enumerable:!0},Sched:{value:function(e,n){return new o.Sched(t,e,n)},enumerable:!0},Interval:{value:function(e,n){return new o.Interval(t,e,n)},enumerable:!0},Timeout:{value:function(e,n){return new o.Timeout(t,e,n)},enumerable:!0}})}t("./shim");var r=t("../util"),o=t("../namespace");o.webaudio=n,o.util=r,o._=t("../util/underscore"),o.DB=t("../util/db"),o.Emitter=t("../util/emitter"),o.FFT=t("../util/fft"),o.KVS=t("../util/kvs"),t("./context"),t("../component"),t("../control"),t("../synth"),o.impl=function(t,e){if(e=e||{},t instanceof o.webaudio.AudioContext?t=t.destination:"undefined"==typeof t&&(t=(new o.webaudio.AudioContext).destination),!(t instanceof o.webaudio.AudioNode))throw new TypeError("neume(): Illegal arguments");var n=new o.Context(t,e);return Object.defineProperties(new i(n),{render:{value:function(t,e){var u=n.sampleRate,s=r.int(u*t);return new Promise(function(r){var a=new o.webaudio.OfflineAudioContext(2,s,u);a.oncomplete=function(t){r(new o.Buffer(n,t.renderedBuffer))},e(new i(new o.Context(a.destination,{duration:t}))),a.startRendering()})}},start:{value:function(){return n.start(),this},enumerable:!0},stop:{value:function(){return n.stop(),this},enumerable:!0},reset:{value:function(){return n.reset(),this},enumerable:!0},analyser:{value:n.analyser,enumerable:!0}})},function(t){Object.keys(t).forEach(function(e){o[e]=t[e]})}(t("../const")),o.register=function(t,e){return o.UGen.register(t,e),o},o.use=function(t){return-1===o.use.used.indexOf(t)&&(t(o,r),o.use.used.push(t)),o},o.use.used=[],e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../component":4,"../const":8,"../control":11,"../namespace":21,"../synth":24,"../util":54,"../util/db":51,"../util/emitter":52,"../util/fft":53,"../util/kvs":55,"../util/underscore":56,"./context":15,"./shim":17}],17:[function(){(function(t){!function(){"use strict";t.AudioContext=t.AudioContext||t.webkitAudioContext,t.OfflineAudioContext=t.OfflineAudioContext||t.webkitOfflineAudioContext,"undefined"!=typeof t.AudioContext&&("function"!=typeof t.AudioContext.prototype.createGain&&(t.AudioContext.prototype.createGain=t.AudioContext.prototype.createGainNode),"function"!=typeof t.AudioContext.prototype.createDelay&&(t.AudioContext.prototype.createDelay=t.AudioContext.prototype.createDelayNode),"function"!=typeof t.AudioContext.prototype.createPeriodicWave&&(t.AudioContext.prototype.createPeriodicWave=t.AudioContext.prototype.createWaveTable),"function"!=typeof t.AudioBufferSourceNode.prototype.start&&(t.AudioBufferSourceNode.prototype.start=t.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof t.AudioBufferSourceNode.prototype.stop&&(t.AudioBufferSourceNode.prototype.stop=t.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof t.OscillatorNode.prototype.start&&(t.OscillatorNode.prototype.start=t.OscillatorNode.prototype.noteOn),"function"!=typeof t.OscillatorNode.prototype.stop&&(t.OscillatorNode.prototype.stop=t.OscillatorNode.prototype.noteOff),"function"!=typeof t.OscillatorNode.prototype.setPeriodicWave&&(t.OscillatorNode.prototype.setPeriodicWave=t.OscillatorNode.prototype.setWaveTable),"undefined"==typeof t.PeriodicWave&&"undefined"!=typeof t.WaveTable&&(t.PeriodicWave=t.WaveTable,t.WaveTable.$$name="PeriodicWave"))}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(t,e){(function(n){"use strict";var i,r=t("../namespace");i="undefined"==typeof n.window?function(){function t(t,e){this.callback=t,this.interval=e,this._timerId=0}return t.$$name="NeuTimer",t.prototype.start=function(){return clearInterval(this._timerId),this._timerId=setInterval(this.callback,this.interval),this},t.prototype.stop=function(){return this._timerId=0|clearInterval(this._timerId),this},t}():function(){function t(t,e){this.callback=t,this.interval=e,this._worker=new n.Worker(i),this._worker.onmessage=function(){t()}}var e=function(){var t=this,e=0;this.onmessage=function(n){clearInterval(e),n.data>0&&(e=setInterval(function(){t.postMessage(0)},n.data))}}.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],i=n.URL.createObjectURL(new n.Blob([e],{type:"text/javascript"}));return t.$$name="NeuTimer",t.prototype.start=function(){return this._worker.postMessage(this.interval),this},t.prototype.stop=function(){return this._worker.postMessage(0),this},t}(),e.exports=r.Timer=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../namespace":21}],19:[function(require,module,exports){"use strict";function NeuTransport(t,e){e=e||{},this.context=t,this.audioContext=t.audioContext,this.sampleRate=t.sampleRate,this._bpm=120,this._events=[],this._nextTicks=[],this._state=INIT,this._currentTime=0,this._duration=util.defaults(e.duration,1/0),this._scheduleInterval=util.defaults(e.scheduleInterval,.025),this._scheduleAheadTime=util.defaults(e.scheduleAheadTime,.1),Object.defineProperties(this,{currentTime:{get:function(){return this._currentTime||this.audioContext.currentTime},enumerable:!0},bpm:{get:function(){return this._bpm},set:function(t){this._bpm=Math.max(1e-6,util.finite(t))},enumerable:!0}})}function startRendering(){var t=0,e=util.clip(util.finite(this._duration),0,MAX_RENDERING_SEC);onaudioprocess(this,t,e)}function startAudioTimer(){var t=this,e=this.audioContext,n=this._scheduleAheadTime;this._timer=new neume.Timer(function(){var i=e.currentTime,r=i+n;onaudioprocess(t,i,r)},1e3*this._scheduleInterval).start()}function ticks2sec(t,e){return 60/e*(t/480)}function note2sec(t,e,n){var i={nt:2/3,nd:1.5}[e]||1;return 0===t?0:ticks2sec(4/t*480*i,n)}function onaudioprocess(t,e,n){var i=t._events;for(t._currentTime=e,t._nextTicks.splice(0).forEach(function(t){t(e)});i.length&&i[0].time<=n;){var r=i.shift();t._currentTime=Math.max(t._currentTime,r.time),r.callback.call(r.context,r.time)}t._currentTime=e}var C=require("../const"),util=require("../util"),neume=require("../namespace"),INIT=0,START=1,STOP=2,MAX_RENDERING_SEC=C.MAX_RENDERING_SEC,schedId=1;require("./timer"),NeuTransport.$$name="NeuTransport",NeuTransport.prototype.start=function(){return this._state===INIT&&(this._state=START,this.audioContext instanceof neume.webaudio.OfflineAudioContext?startRendering.call(this):startAudioTimer.call(this)),this},NeuTransport.prototype.stop=function(){return this._state===START&&(this._state=STOP,this.reset()),this},NeuTransport.prototype.reset=function(){return this._timer&&(this._timer.stop(),this._timer=null),this._events=[],this._nextTicks=[],this._state=INIT,this._currentTime=0,this},NeuTransport.prototype.sched=function(t,e,n){if("function"!=typeof e)return 0;t=util.finite(t);var i=this._events,r={id:schedId++,time:t,callback:e,context:n||this};if(0===i.length||i[i.length-1].time<=t)i.push(r);else for(var o=0,u=i.length;u>o;o++)if(t<i[o].time){i.splice(o,0,r);break}return r.id},NeuTransport.prototype.unsched=function(t){if(t=util.finite(t),0!==t)for(var e=this._events,n=0,i=e.length;i>n;n++)if(t===e[n].id){e.splice(n,1);break}return t},NeuTransport.prototype.nextTick=function(t,e){return this._nextTicks.push(t.bind(e||this)),this},NeuTransport.prototype.toSeconds=function(value){if("number"==typeof value)return util.finite(value);if(value&&"number"==typeof value.playbackTime)return util.finite(value.playbackTime);if("string"==typeof value){var m,offset=0,time=0;"+"===value.charAt(0)&&(offset=this.currentTime,value=value.slice(1));var components=value.split(/[\(\)\-\+\/\*]/);if(components.length>1){for(var oringalTime=value,expr=value,i=0,imax=components.length;imax>i;i++){var symb=components[i].trim();""!==symb&&(expr=expr.replace(symb,this.toSeconds(symb)))}try{time=eval(expr)}catch(e){throw new EvalError("Invalid Time Value Syntax: "+oringalTime)}}else{if("now"===value)return this.currentTime;time=null!==(m=/^(\d+)ms$/.exec(value))?.001*+m[1]:null!==(m=/^(\d+(?:\.\d+)?)hz$/.exec(value))?util.finite(1/+m[1]):null!==(m=/^(\d+)ticks$/.exec(value))?ticks2sec(+m[1],this._bpm):null!==(m=/^(\d+)(n[td]?)$/.exec(value))?note2sec(+m[1],m[2],this._bpm):null!==(m=/^(\d+)\.(\d+)\.(\d+)$/.exec(value))?ticks2sec(480*(4*+m[1]+ +m[2])+ +m[3],this._bpm):null!==(m=/^(\d\d):(\d\d):(\d\d)(?:\.(\d+))?$/.exec(value))?3600*+m[1]+60*+m[2]+ +m[3]+.001*((m[4]||"")+"000").substr(0,3):null!==(m=/^(\d+)samples$/.exec(value))?+m[1]/this.sampleRate:util.finite(+value)}return time+offset}return value},module.exports=neume.Transport=NeuTransport},{"../const":8,"../namespace":21,"../util":54,"./timer":18}],20:[function(t,e){e.exports=t("./core/neume")},{"./core/neume":16}],21:[function(t,e){"use strict";function n(){return n.impl.apply(null,arguments)}n.version="0.8.1",e.exports=n},{}],22:[function(t,e){"use strict";function n(t){this.context=this,this.audioContext=t.audioContext,this.sampleRate=t.sampleRate,this._context=t,this._nodes=[]}var i=t("../util"),r=t("../namespace");t("../core/context"),i.inherits(n,r.Context),n.$$name="NeuSynthContext",n.prototype.start=function(){return this._context.start(),this},n.prototype.stop=function(){return this._context.stop(),this},n.prototype.reset=function(){return this._context.reset(),this},n.prototype.sched=function(t,e,n){return this._context.sched(t,e,n)},n.prototype.unsched=function(t){return this._context.unsched(t)},n.prototype.nextTick=function(t,e){return this._context.nextTick(t,e),this},n.prototype.getAudioBus=function(t){return this._context.getAudioBus(t)},n.prototype.toSeconds=function(t){return this._context.toSeconds(t)},e.exports=r.SynthContext=n},{"../core/context":15,"../namespace":21,"../util":54}],23:[function(t,e){"use strict";function n(t){function e(){var e,i,a=o.toArray(arguments),c=a.shift(),l=o.isPlainObject(a[0])?a.shift():{},f=o.flatten(a);if("string"==typeof c){if("@"===c.charAt(0))return c=c.substr(1),r(c,l,f.pop(),f);if("#"===c.charAt(0))return c=c.substr(1),e=s[c]||n.find({id:c})[0],null==e&&(e=new u.UGenPromise(t,c),s[c]=e),e}return e=u.UGen.build(t,c,l,f),e.id&&(i=s[e.id],i&&i.resolve(e),s[e.id]=null),n.append(e),e}var n=new u.DB,r=i(t),s={};e.timeout=function(t){return{next:function(){return{value:t,done:!0}}}},e.interval=function(t){return{next:function(){return{value:t,done:!1}}}},e.stop=function(e){t.context.sched(t.context.toSeconds(e),function(e){t.stop(e)})},e.inputs=[],this.db=n,this.builder=e}function i(t){var e={};return function(n,i,s,a){if(e.hasOwnProperty(n))return e[n];r(n,s),s=o.finite(o.defaults(s,0));var c=new u.Param(t.context,s,i);
Object.defineProperty(t,n,{value:c,enumerable:!0});var l;return a.length?(l=u.UGen.build(t,"+",i,[a]),l=u.UGen.build(t,"+",{mul:c},[l])):l=u.UGen.build(t,"+",i,[c]),e[n]=l,l}}function r(t){if(!/^[a-z]\w*$/.test(t))throw new TypeError(o.format("invalid parameter name: #{name}",{name:t}))}var o=t("../util"),u=t("../namespace");t("../component/param"),t("./ugen"),t("./ugen-promise"),e.exports=u.SynthDollar=n},{"../component/param":6,"../namespace":21,"../util":54,"./ugen":28,"./ugen-promise":27}],24:[function(t){t("./dollar"),t("./synth"),t("./ugen"),t("./unit")},{"./dollar":23,"./synth":26,"./ugen":28,"./unit":29}],25:[function(t,e){"use strict";function n(t){var e=r.exec(t);return!!e&&e[0]===t}function i(t){t=String(t);var e={key:"",id:null,classes:[]},n=t.match(r);n&&(e.key=n[0],t=t.substr(e.key.length));var i=t.match(/[.#][a-zA-Z](-?[a-zA-Z0-9]+)*/g);return i&&i.forEach(function(t){var n=t.charAt(0);"#"===n?e.id||(e.id=t.substr(1)):e.classes.push(t.substr(1))}),e}var r=/^([a-zA-Z](-?[a-zA-Z0-9]+)*!?\??~?|[-+*\/%<=>!?&|]+~?)/;e.exports={isValidUGenName:n,parse:i}},{}],26:[function(t,e){"use strict";function n(t,e,n){s.call(this),this.context=new u.SynthContext(t),this.routes=[];var o=new u.SynthDollar(this);this.builder=o.builder,this.scheds=[];var a=new u.Param(t,1,{curve:"lin"}),f=e.apply(this,[o.builder].concat(n));f&&f.toAudioNode&&!f.isOutput&&(this.routes[0]=f),this.routes=this.routes.map(function(e){var n=t.createGain();return t.connect(e,n),t.connect(a,n.gain),n}),this._connected=!1,this._db=this.routes.length?o.db:c,this._state=l,this._stateString="UNSCHEDULED",this._param=a,this._scheds=null,this.methods=i(this._db),this.methods.filter(function(t){return!this.hasOwnProperty(t)},this).forEach(function(t){Object.defineProperty(this,t,{value:function(){var e=r.toArray(arguments);return this._db.all().forEach(function(n){"function"==typeof n[t]&&n[t].apply(n,e)}),this}})},this),Object.defineProperties(this,{state:{get:function(){return this._stateString},enumerable:!0}})}function i(t){var e={};return t.all().forEach(function(t){t.methods.forEach(function(t){e[t]=!0})}),Object.keys(e).sort()}var r=t("../util"),o=t("../util/db"),u=t("../namespace"),s=t("../util/emitter"),a=t("./parser");t("./dollar"),t("./context");var c=new o,l=0,f=1,h=2;r.inherits(n,s),n.$$name="NeuSynth",n.prototype.query=function(t){var e=this._db.find(a.parse(t));return["on","once","off","trig"].concat(this.methods).forEach(function(t){e[t]=function(){var n=r.toArray(arguments);return e.forEach(function(e){"function"==typeof e[t]&&e[t].apply(e,n)}),e}}),e},n.prototype.start=function(t){if(this._state!==l)return this;var e=this.context;return t=r.defaults(e.toSeconds(t),e.currentTime),t=r.finite(t),this._state=f,this._stateString="SCHEDULED",e.sched(t,function(){this._stateString="PLAYING",this.routes.forEach(function(t,n){e.getAudioBus(n).append(this)},this),this._db.all().forEach(function(e){e.start(t)}),this._scheds=this.scheds.splice(0).map(function(n){return new u.Sched(e,n[0],n[1]).start(t)},this),this.emit("start",{type:"start",playbackTime:t})},this),e.start(),this},n.prototype.stop=function(t){if(this._state!==f)return this;var e=this.context;return t=r.defaults(e.toSeconds(t),e.currentTime),t=r.finite(t),this._state=h,e.sched(t,function(n){this._stateString="FINISHED",this.routes.forEach(function(t,n){e.getAudioBus(n).remove(this)}),e.nextTick(function(){e.dispose()}),this._db.all().forEach(function(t){t.stop(n)}),this._scheds.forEach(function(t){t.stop(n)}),this.emit("stop",{type:"stop",playbackTime:t})},this),this},n.prototype.trig=function(t){return this._db.all().forEach(function(e){e.trig(t)}),this},n.prototype.fadeIn=function(t,e){if(this._state!==l)return this;var n=this.context;return t=r.defaults(n.toSeconds(t),n.currentTime),t=r.finite(t),this.routes.length&&(e=r.defaults(n.toSeconds(e),.5),e=r.finite(e),this._param.value=0,n.sched(t,function(t){this._param.update(1,t,e)},this)),this.start(t),this},n.prototype.fadeOut=function(t,e){if(this._state!==f)return this;var n=this.context;return t=r.defaults(n.toSeconds(t),n.currentTime),t=r.finite(t),e=r.defaults(n.toSeconds(e),.5),e=r.finite(e),this.routes.length&&n.sched(t,function(t){this._param.update(0,t,e)},this),this.stop(t+e),this},n.prototype.fade=function(t,e,n){if(this._state!==f)return this;var i=this.context;return this.routes.length&&(t=r.defaults(i.toSeconds(t),i.currentTime),t=r.finite(t),e=r.finite(e),n=r.defaults(i.toSeconds(n),.5),n=r.finite(n),i.sched(t,function(t){this._param.update(e,t,n)},this)),this},n.prototype.toAudioNode=function(t){return t=r.int(t),this.routes[t]?this.context.toAudioNode(this.routes[t]):null},e.exports=u.Synth=n},{"../namespace":21,"../util":54,"../util/db":51,"../util/emitter":52,"./context":22,"./dollar":23,"./parser":25}],27:[function(t,e){"use strict";function n(t,e){this.context=t.context,this.synth=t,this.key="",this.classes=[],this.id=e,this.outlet=null,this._resolved=!1,this._to=[],this._from=[]}var i=t("../util"),r=t("../namespace");t("./ugen"),i.inherits(n,r.UGen),n.$$name="NeuUGenPromise",n.prototype.resolve=function(t){return this._to.forEach(function(e){this.context.connect(t,e)},this),this._from.forEach(function(e){this.context.connect(e,t)},this),this._to=this._from=null,this},n.prototype.connect=function(t){return this._to.push(t),this},n.prototype.onconnected=function(t){this._from.push(t)},e.exports=r.UGenPromise=n},{"../namespace":21,"../util":54,"./ugen":28}],28:[function(t,e){"use strict";function n(t,e,l,f){a.call(this);var h=c.parse(e);if(!n.registered.hasOwnProperty(h.key))throw new Error("unknown key: "+e);this.context=t.context,this.synth=t,this.key=h.key,this.classes=h.classes,this.id=h.id,this.outlet=null,o(this,"mute")?(this._unit=new s.Unit({}),this._node=this.context.createGain()):o(this,"bypass")?(this._unit=n.registered["+"](this,{},f),this._node=this._unit.outlet):(this._unit=n.registered[h.key](this,l,f),this._node=this._unit.outlet,this._node=i(this.context,this._node,u.defaults(l.mul,1)),this._node=r(this.context,this._node,u.defaults(l.add,0))),this.isOutput=!!this._unit.isOutput,this.methods=Object.keys(this._unit.methods).sort(),this.methods.forEach(function(t){var e=this._unit.methods[t];u.definePropertyIfNotExists(this,t,{value:function(){var t=this.context,n=u.toArray(arguments);return t.sched(t.toSeconds(n[0]),function(){e.apply(null,n)}),this}})},this),this._scheds=[]}function i(t,e,n){if(1===n)return e;if(0===n)return new s.DC(t,0);var i=t.createGain();return i.gain.value=0,t.connect(e,i),t.connect(n,i.gain),i}function r(t,e,n){return new s.Sum(t,[e,n])}function o(t,e){return-1!==t.classes.indexOf(e)}var u=t("../util"),s=t("../namespace"),a=t("../util/emitter"),c=t("./parser");u.inherits(n,a),n.$$name="NeuUGen",n.registered={},n.register=function(t,e){if(!c.isValidUGenName(t))throw new Error("invalid ugen name: "+t);if("function"!=typeof e)throw new TypeError("ugen must be a function");n.registered[t]=e},n.build=function(t,e,i,r){if("string"!=typeof e){var o=u.typeOf(e);"object"!=typeof e||n.registered.hasOwnProperty(o)||(o="object"),i.value=e,e=o}return new n(t,e,i,r)},n.prototype.$=function(){var t=u.toArray(arguments),e=t.shift(),n=u.isPlainObject(t[0])?t.shift():{},i=Array.prototype.concat.apply([this],t);return this.synth.builder(e,n,i)},n.prototype.mul=function(t){return this.synth.builder("*",this,u.defaults(t,1))},n.prototype.add=function(t){return this.synth.builder("+",this,u.defaults(t,0))},n.prototype.start=function(t){return o(this,"trig")||this._unit.start(t),this},n.prototype.stop=function(t){return this._unit.stop(t),this},n.prototype.trig=function(t){var e=this.context;return t=u.finite(e.toSeconds(t)),e.sched(t,function(){this._unit.start(t)},this),this},n.prototype.sched=function(t,e){if(u.isIterator(t)&&"function"==typeof e){var n=this.synth;n.scheds.push([t,function(t){"start"===t.type||"stop"===t.type&&!t.done||e.call(n,t)}])}return this},n.prototype.toAudioNode=function(){return null===this.outlet&&(this.outlet=this.context.toAudioNode(this._node)),this.outlet},n.prototype.connect=function(t){return this._node.connect(t),this},n.prototype.disconnect=function(){return this._node.disconnect(),this},e.exports=s.UGen=n},{"../namespace":21,"../util":54,"../util/emitter":52,"./parser":25}],29:[function(t,e){"use strict";function n(t){this.outlet=i.defaults(t.outlet,null),this.methods=i.defaults(t.methods,{}),this.isOutput=!!t.isOutput,this._spec=t,this._state=o}var i=t("../util"),r=t("../namespace"),o=0,u=1,s=2;n.$$name="NeuUnit",n.prototype.start=function(t){this._state===o&&"function"==typeof this._spec.start&&(this._state=u,this._spec.start(i.finite(t)))},n.prototype.stop=function(t){this._state===u&&"function"==typeof this._spec.stop&&(this._state=s,this._spec.stop(i.finite(t)))},e.exports=r.Unit=n},{"../namespace":21,"../util":54}],30:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,i){return new t.Unit({outlet:new t.Sum(e.context,i)})}t.register("+",function(t,e,i){return n(t,e,i)}),t.register("array",function(t,i,r){return r=e.toArray(i.value).concat(r),n(t,i,r)})}},{}],31:[function(t,e){e.exports=function(t){"use strict";function e(e,n,i){var r=e.context,o=n.value;return Object.keys(n).forEach(function(e){"undefined"!=typeof o[e]&&(o[e]instanceof t.webaudio.AudioParam?r.connect(n[e],o[e]):o[e]=n[e])}),o.numberOfInputs&&r.connect(i,o),new t.Unit({outlet:o})}["AudioBufferSourceNode","MediaElementAudioSourceNode","MediaStreamAudioSourceNode","ScriptProcessorNode","GainNode","BiquadFilterNode","DelayNode","PannerNode","ConvolverNode","AnalyserNode","DynamicsCompressorNode","WaveShaperNode","OscillatorNode"].forEach(function(n){t.register(n,function(t,n,i){return e(t,n,i)})})}},{}],32:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r,o){var u=i.context,s=u.createBiquadFilter();s.type=n,s.frequency.value=0,s.detune.value=0,s.Q.value=0,s.gain.value=0;var a=e.defaults(r.freq,r.frequency,350),c=e.defaults(r.dt,r.detune,0),l=e.defaults(r.q,r.Q,1),f=e.defaults(r.gain,0);return u.connect(a,s.frequency),u.connect(c,s.detune),u.connect(l,s.Q),u.connect(f,s.gain),u.connect(o,s),new t.Unit({outlet:s})}var i={lowpass:"lowpass",highpass:"highpass",bandpass:"bandpass",lowshelf:"lowshelf",highshelf:"highshelf",peaking:"peaking",notch:"notch",allpass:"allpass",lpf:"lowpass",hpf:"highpass",bpf:"bandpass"};t.register("biquad",function(t,e,r){var o=i[e.type]||"lowpass";return n(o,t,e,r)}),Object.keys(i).forEach(function(e){var r=i[e];t.register(e,function(t,e,i){return n(r,t,e,i)})})}},{}],33:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r){function o(t){a.start(t),a.onended=function(){i.emit("end",{type:"end",synth:i.synth,playbackTime:t+c})}}function u(t){a.onended=null,a.stop(t)}var s=i.context,a=s.createBufferSource(),c=0;return n=s.toAudioBuffer(n),null!=n&&(a.buffer=n,c=n.duration),a.loop=!!e.defaults(r.loop,!1),a.loopStart=e.finite(e.defaults(r.start,r.loopStart,0)),a.loopEnd=e.finite(e.defaults(r.end,r.loopEnd,0)),a.playbackRate.value=0,s.connect(e.defaults(r.rate,r.playbackRate,1),a.playbackRate),new t.Unit({outlet:a,start:o,stop:u})}t.register("buf",function(t,i){return n(e.defaults(i.buf,i.buffer),t,i)}),t.register("AudioBuffer",function(t,e){return n(e.value,t,e)}),t.register("NeuBuffer",function(t,e){return n(e.value,t,e)})}},{}],34:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r){var o=n.context,u=o.createDynamicsCompressor();u.threshold.value=0,u.knee.value=0,u.ratio.value=0,u.attack.value=0,u.release.value=0;var s=e.defaults(i.thresh,i.threshold,-24),a=e.defaults(i.knee,30),c=e.defaults(i.ratio,12),l=e.defaults(i.a,i.attack,i.attackTime,.003),f=e.defaults(i.r,i.release,i.releaseTime,.25);return l=o.toSeconds(l),f=o.toSeconds(f),o.connect(s,u.threshold),o.connect(a,u.knee),o.connect(c,u.ratio),o.connect(l,u.attack),o.connect(f,u.release),o.connect(r,u),new t.Unit({outlet:u})}t.register("comp",function(t,e,i){return n(t,e,i)})}},{}],35:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r){var o=n.context,u=o.createConvolver(),s=e.defaults(i.buf,i.buffer);return s=o.toAudioBuffer(s),null!=s&&(u.buffer=s),u.normalize=!!e.defaults(i.norm,i.normalize,!0),o.connect(r,u),new t.Unit({outlet:u})}t.register("conv",function(t,e,i){return n(t,e,i)})}},{}],36:[function(t,e){e.exports=function(t,e){"use strict";function n(n,r,o){var u,s=n.context,a=s.toSeconds(e.defaults(r.delay,r.delayTime,0)),c=e.defaults(r.fb,r.feedback,0);"number"==typeof a?(a=e.clip(e.finite(a),0,i),u=a):u=e.finite(s.toSeconds(e.defaults(r.maxDelay,r.maxDelayTime,1))),u=e.clip(u,1/s.sampleRate,i);var l=s.createDelay(u);if(l.delayTime.value=0,s.connect(a,l.delayTime),0!==c){var f=s.createGain();f.gain.value=0,s.connect(l,f),s.connect(c,f.gain),o=o.concat(f)}return s.connect(o,l),new t.Unit({outlet:l})}var i=t.MAX_DELAY_SEC;t.register("delay",function(t,e,i){return n(t,e,i)})}},{}],37:[function(t,e){e.exports=function(t,e){"use strict";function n(n,o,u){var s=n.context,a=e.defaults(o.mix,0),c=e.defaults(o.efx,o.wet,null),l=e.defaults(o.args,[]),f=u,h=null;if("function"==typeof c){var p=n.synth.builder,d=function(){return p.apply(null,arguments)};d.timeout=p.timeout,d.interval=p.interval,d.stop=p.stop,d.inputs=u,h=c.apply(n.synth,[d].concat(l))}var m;return m=null==h||"number"==typeof a?i(s,f,h,a):r(s,f,h,a),new t.Unit({outlet:m})}function i(n,i,r,o){if(o=e.clip(e.finite(o),-1,1),-1===o||null==r)return new t.Sum(n,i);if(1===o)return new t.Sum(n,r);o=.25*(o+1)*Math.PI;var u=n.createGain(),s=n.createGain();return u.gain.value=Math.cos(o),s.gain.value=Math.sin(o),n.connect(i,u),n.connect(r,s),new t.Sum(n,[u,s])}function r(e,n,i,r){var o=e.createGain(),s=e.createGain(),a=e.createWaveShaper(),c=e.createWaveShaper(),l=t.KVS.get(u+"curve");return a.curve=l.dry,c.curve=l.wet,o.gain.value=0,s.gain.value=0,e.connect(r,a),e.connect(r,c),e.connect(a,o.gain),e.connect(c,s.gain),e.connect(n,o),e.connect(i,s),new t.Sum(e,[o,s])}var o=t.WS_CURVE_SIZE,u="@neume:drywet:";t.register("drywet",function(t,e,i){return n(t,e,i)}),t.KVS.set(u+"curve",function(){for(var t=new Float32Array(o),e=new Float32Array(o),n=0;o>n;n++)t[n]=Math.cos(n/o*Math.PI*.5),e[n]=Math.sin(n/o*Math.PI*.5);return{dry:t,wet:e}})}},{}],38:[function(t,e){e.exports=function(t,e){"use strict";function n(t,n){for(var i=[],r={init:e.finite(t.shift()),list:i,releaseNode:-1,loopNode:-1,index:0,length:0},o=0,u=t.length;u>o;){var s=t[o++];"number"==typeof s?i.push([n(e.clip(e.finite(s),0,1)),t[o++]]):(/^(>|r(elease)?)$/i.test(s)&&(r.releaseNode=i.length),/^(<|l(oop)?)$/i.test(s)&&(r.loopNode=i.length))}return r.length=i.length,r}function i(e,n,i){var o,u=null;return"number"==typeof i&&(t.KVS.exists(s+i)||t.KVS.set(s+i,r(i))),t.KVS.exists(s+i)&&(u=t.KVS.get(s+i)),null!=u&&(o=e.createWaveShaper(),o.curve=u,e.connect(n,o),n=o),n}function r(t){for(var e=new Float32Array(4096),n=Math.exp(t),i=1/(1-n),r=0;2048>r;r++){var o=r/2048;e[r+2048]=i-i*Math.pow(n,o)}return e}function o(t){return"number"==typeof t?function(e){var n=1/(1-Math.exp(t));return Math.log((n-e)/n)/t}:a[t]||a.identity}function u(r,u,s,a){function c(t){_.index=0,g.setValueAtTime(_.init,t),0!==_.releaseNode&&(v=d.sched(t,h))}function l(t){p(t),g.setValueAtTime(g.valueAtTime(t),t),d.unsched(v),d.unsched(y),v=0,_.index=_.length,w=!0}function f(t){w||y||-1===_.releaseNode||(t=e.finite(d.toSeconds(t)),y=d.sched(t,function(t){d.unsched(v),v=0,_.index=_.releaseNode,b=!0,p(t),h(t)}))}function h(t){var n=_.list[_.index];if(null!=n){_.index+=1;var i=e.finite(d.toSeconds(n[1])),r=t+i,o=g.valueAtTime(t),s=e.finite(n[0]);switch(m){case"step":g.setValueAtTime(s,t);break;case"hold":g.setValueAtTime(o,t),g.setValueAtTime(s,r);break;case"exp":case"exponential":g.setValueAtTime(Math.max(1e-6,o),t),g.exponentialRampToValueAtTime(Math.max(1e-6,s),r),x={method:"exponentialRampToValueAtTime",time:r};break;default:g.setValueAtTime(o,t),g.linearRampToValueAtTime(s,r),x={method:"linearRampToValueAtTime",time:r}}b||-1===_.loopNode||(_.index===_.releaseNode||_.index===_.length)&&(_.index=_.loopNode),v=0,_.index===_.length?v=d.sched(r,function(t){v=0,u.emit("end",{type:"end",synth:u.synth,playbackTime:t})}):_.index!==_.releaseNode&&(v=d.sched(r,h))}}function p(t){if(!(null==x||x.time<=t)){var e=g.valueAtTime(t);g.cancelScheduledValues(x.time),g[x.method](e,t)}}var d=u.context,m=e.defaults(s.curve,"lin");"number"==typeof m&&(m=e.finite(m),Math.abs(m)<.001&&(m="lin"));var v,y,x,_=n(r,o(m)),g=new t.Param(d,_.init),b=!1,w=!1,A=a.length?g.toAudioNode(a):g;return A=i(d,A,m),new t.Unit({outlet:A,start:c,stop:l,methods:{release:f}})}var s="@neume:env:";t.register("env",function(t,n,i){return u(e.toArray(n.table),t,n,i)}),t.register("adsr",function(t,n,i){var r=e.defaults(n.a,n.attackTime,.01),o=e.defaults(n.d,n.decayTime,.3),s=e.defaults(n.s,n.sustainLevel,.5),a=e.defaults(n.r,n.releaseTime,1);return u([0,1,r,s,o,">",0,a],t,n,i)}),t.register("asr",function(t,n,i){var r=e.defaults(n.a,n.attackTime,.01),o=e.defaults(n.s,n.sustainLevel,1),s=e.defaults(n.r,n.releaseTime,1);return u([0,o,r,">",0,s],t,n,i)}),t.register("cutoff",function(t,n,i){var r=e.defaults(n.r,n.releaseTime,.1);return u([1,">",0,r],t,n,i)}),t.KVS.set(s+"sine",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n-.15*Math.sin(2*n*Math.PI)}return t}),t.KVS.set(s+"welch",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=Math.sin(.5*n*Math.PI)}return t}),t.KVS.set(s+"squared",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n*n}return t}),t.KVS.set(s+"cubic",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n*n*n}return t});var a={sine:function(t){var e,n,i=1,r=0;if(0===t)return 0;if(1===t)return 1;for(;;){if(e=.5*(i+r),n=e-.15*Math.sin(2*e*Math.PI),Math.abs(t-n)<1e-6)break;t>n?r=e:i=e}return e},welch:function(t){return 2*Math.asin(t)/Math.PI},squared:function(t){return Math.pow(t,.5)},cubic:function(t){return Math.pow(t,1/3)},identity:function(t){return t}}}},{}],39:[function(t,e){e.exports=function(e){"use strict";e.use(t("./add")),e.use(t("./audio-node")),e.use(t("./biquad")),e.use(t("./buf")),e.use(t("./comp")),e.use(t("./conv")),e.use(t("./delay")),e.use(t("./drywet")),e.use(t("./env")),e.use(t("./inout")),e.use(t("./iter")),e.use(t("./lfpulse")),e.use(t("./line")),e.use(t("./mono")),e.use(t("./mul")),e.use(t("./noise")),e.use(t("./object")),e.use(t("./osc")),e.use(t("./pan2")),e.use(t("./shaper"))}},{"./add":30,"./audio-node":31,"./biquad":32,"./buf":33,"./comp":34,"./conv":35,"./delay":36,"./drywet":37,"./env":38,"./inout":40,"./iter":41,"./lfpulse":42,"./line":43,"./mono":44,"./mul":45,"./noise":46,"./object":47,"./osc":48,"./pan2":49,"./shaper":50}],40:[function(t,e){e.exports=function(t,e){"use strict";var n=t.AUDIO_BUS_CHANNELS;t.register("in",function(i,r){var o=i.context,u=e.clip(e.int(e.defaults(r.bus,0)),0,n);return new t.Unit({outlet:o.getAudioBus(u)})}),t.register("out",function(i,r,o){var u=i.context,s=new t.Sum(u,o),a=e.clip(e.int(e.defaults(r.bus,0)),0,n);return i.synth.routes[a]=s,new t.Unit({outlet:s,isOutput:!0})})}},{}],41:[function(t,e){e.exports=function(t,e){"use strict";function n(n,o,u){function s(t){var i=c();i.done?(h=r,n.emit("end",{type:"end",synth:n.synth,playbackTime:t})):p.setValueAtTime(e.finite(i.value),t)}function a(t){if(h===i){t=e.finite(l.toSeconds(t));var o=c();o.done?(h=r,n.emit("end",{type:"end",synth:n.synth,playbackTime:t})):p.update(e.finite(o.value),t)}}function c(){return e.isIterator(f)?f.next():{done:!0}}var l=n.context,f=e.defaults(o.iter,null),h=i,p=new t.Param(l,0,o),d=u.length?p.toAudioNode(u):p;return new t.Unit({outlet:d,start:s,methods:{next:a}})}var i=0,r=1;t.register("iter",function(t,e,i){return n(t,e,i)})}},{}],42:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,o){var u=o.length?r(e,n,o):i(e,n),s=u.outlet,a=u.ctrl;return new t.Unit({outlet:s,start:function(t){a.start(t)},stop:function(t){a.stop(t)}})}function i(t,e){var n=o(t.context,e,440);return{outlet:n.outlet,ctrl:n.ctrl}}function r(t,e,n){var i=t.context,r=o(i,e,2),u=t.context.createGain();return u.gain.value=0,i.connect(r.outlet,u.gain),i.connect(n,u),{outlet:u,ctrl:r.ctrl}}function o(n,i,r){var o,l=e.defaults(i.width,i.duty,.5),f=u(n,i,r),h=s(n,t.KVS.get(c+"ws-curve"));return"number"==typeof l?o=-2*l:(o=a(n,-2),n.connect(l,o)),n.connect([f,1,o],h),{outlet:h,ctrl:f}}function u(n,i,r){var o=n.createOscillator();o.setPeriodicWave(t.KVS.get(c+"src",n)),o.frequency.value=0,o.detune.value=0;var u=e.defaults(i.freq,i.frequency,r),s=e.defaults(i.dt,i.detune,0);return n.connect(u,o.frequency),n.connect(s,o.detune),o}function s(t,e){var n=t.createWaveShaper();return n.curve=e,n}function a(t,e){var n=t.createGain();return n.gain.value=e,n}var c="@neume:lfpulse:";t.register("lfpulse",function(t,e,i){return n(t,e,i)}),t.KVS.set(c+"src",function(t){for(var e=new Float32Array(4096),n=new Float32Array(4096),i=1;4096>i;i++)n[i]=1/i,i%2===0&&(n[i]*=-1);return t.createPeriodicWave(e,n)}),t.KVS.set(c+"ws-curve",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++)t[e]=-1,t[e+2048]=1;return t})}},{}],43:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,i,r,o,u){function s(t){var u=t,s=u+o;f.setAt(i,u),f[e](r,s),l=c.sched(s,function(t){l=0,n.emit("end",{type:"end",synth:n.synth,playbackTime:t})})}function a(){c.unsched(l)}var c=n.context,l=0,f=new t.Param(c,i),h=u.length?f.toAudioNode(u):f;return new t.Unit({outlet:h,start:s,stop:a})}t.register("line",function(t,i,r){var o=e.finite(e.defaults(i.start,i.startValue,i.from,1)),u=e.finite(e.defaults(i.end,i.endValue,i.to,0)),s=e.finite(t.context.toSeconds(e.defaults(i.dur,i.duration,1)));return n("linTo",t,o,u,s,r)}),t.register("xline",function(t,i,r){var o=Math.max(1e-6,e.finite(e.defaults(i.start,i.startValue,i.from,1))),u=Math.max(1e-6,e.finite(e.defaults(i.end,i.endValue,i.to,0))),s=e.finite(t.context.toSeconds(e.defaults(i.dur,i.duration,1)));return n("expTo",t,o,u,s,r)})}},{}],44:[function(t,e){e.exports=function(t){"use strict";function e(e,n,i){var r=e.context,o=r.createGain();return o.channelCount=1,o.channelCountMode="explicit",o.channelInterpretation="speakers",r.connect(i,o),new t.Unit({outlet:o})}t.register("mono",function(t,n,i){return e(t,n,i)})}},{}],45:[function(t,e){e.exports=function(t,e){"use strict";function n(t){for(var n=1,i=[],r=0,o=t.length;o>r;r++)"number"==typeof t[r]?n*=t[r]:i.push(t[r]);return{multiple:e.finite(n),nodes:i}}function i(e,n,i){var r=e.context;if(0===i)return new t.DC(r,0);if(0===n.length)return new t.DC(r,i);if(1===n.length&&1===i)return n[0];1!==i&&n.push(i);for(var u,s=n[0],a=1,c=n.length;c>a;a++)u=o(r,n[a]),r.connect(s,u),s=u;return s}function r(e){return new t.Unit({outlet:e})}function o(t,e){var n=t.createGain();return"number"==typeof e?n.gain.value=e:(n.gain.value=0,t.connect(e,n.gain)),n}t.register("*",function(t,e,o){var u=n(o);return r(i(t,u.nodes,u.multiple))})}},{}],46:[function(t,e){e.exports=function(t){"use strict";function e(e,r){var o=r.context,u=o.createBufferSource();return u.buffer=t.KVS.get(i+e,o,n),u.loop=!0,new t.Unit({outlet:u,start:function(t){u.start(t)},stop:function(t){u.stop(t)}})}var n=4,i="@neume:noise:";t.register("noise",function(t,n){var i={pink:"pink",brown:"brown"}[n.type]||"white";return e(i,t)}),["white","pink","brown"].forEach(function(n){t.register(n,function(t){return e(n,t)})}),t.KVS.set(i+"white",function(t,e){for(var n=t.sampleRate*e,i=new Float32Array(n),r=0,o=i.length;o>r;r++)i[r]=2*Math.random()-1;var u=t.createBuffer(1,n,t.sampleRate);return u.getChannelData(0).set(i),u}),t.KVS.set(i+"pink",function(t,e){for(var n,i=t.sampleRate*e,r=new Float32Array(i),o=0,u=0,s=0,a=0,c=0,l=0,f=0,h=0,p=r.length;p>h;h++)n=2*Math.random()-1,o=.99886*o+.0555179*n,u=.99332*u+.0750759*n,s=.969*s+.153852*n,a=.8665*a+.3104856*n,c=.55*c+.5329522*n,l=-.7616*l-.016898*n,r[h]=o+u+s+a+c+l+f+.5362*n,r[h]*=.11,f=.115926*n;var d=t.createBuffer(1,i,t.sampleRate);return d.getChannelData(0).set(r),d}),t.KVS.set(i+"brown",function(t,e){for(var n,i=t.sampleRate*e,r=new Float32Array(i),o=0,u=0,s=r.length;s>u;u++)n=2*Math.random()-1,r[u]=(o+.02*n)/1.02,o=r[u],r[u]*=3.5;var a=t.createBuffer(1,i,t.sampleRate);return a.getChannelData(0).set(r),a})}},{}],47:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r){function o(t){var n=e.finite(f());n!==p&&(d.update(n,t),p=n);var i=Math.max(h,e.finite(u.toSeconds(c)));l=u.sched(t+i,o)}var u=n.context,s=e.defaults(i.value,0),a=e.defaults(i.i,i.index,i.key,""),c=e.defaults(i.poll,i.pollTime,i.interval,.25),l=0,f=null;f="string"!=typeof a&&"number"!=typeof a||!s.hasOwnProperty(a)?function(){return s.valueOf()}:"function"==typeof s[a]?function(){return s[a]()}:function(){return s[a]};var h=1/u.sampleRate,p=e.finite(f()),d=new t.Param(u,p,i),m=r.length?d.toAudioNode(r):d;return new t.Unit({outlet:m,start:function(t){o(t)},stop:function(){u.unsched(l),l=0}})}t.register("object",n),t.register("Float32Array",n)}},{}],48:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,o,u){var s=u.length?r(e,n,o,u):i(e,n,o),a=s.outlet,c=s.ctrl;return new t.Unit({outlet:a,start:function(t){c.start(t)},stop:function(t){c.stop(t)}})}function i(t,e,n){var i=o(e.context,t,n,440);return{outlet:i,ctrl:i}}function r(t,e,n,i){var r=e.context,u=o(r,t,n,2),s=e.context.createGain();return s.gain.value=0,r.connect(u,s.gain),r.connect(i,s),{outlet:s,ctrl:u}}function o(t,n,i,r){var o=t.createOscillator();u(n)?o.setPeriodicWave(n):o.type=n,o.frequency.value=0,o.detune.value=0;var s=e.defaults(i.freq,i.frequency,r),a=e.defaults(i.dt,i.detune,0);return t.connect(s,o.frequency),t.connect(a,o.detune),o}function u(e){return e instanceof t.webaudio.PeriodicWave}var s={sin:"sine",square:"square",saw:"sawtooth",tri:"triangle"};t.register("osc",function(t,e,i){var r=e.type;return u(r)||(r=s[r]||"sine"),n(r,t,e,i)}),t.register("PeriodicWave",function(t,e,i){var r=e.value;return u(r)||(r="sine"),n(r,t,e,i)}),Object.keys(s).forEach(function(e){var i=s[e];t.register(e,function(t,e,r){return n(i,t,e,r)})})}},{}],49:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){var u=n.context,s=u.createGain(),a=u.createGain();s.channelCount=1,s.channelCountMode="explicit",s.channelInterpretation="speakers",a.channelCount=1,a.channelCountMode="explicit",a.channelInterpretation="speakers";var c=e.defaults(i.pos,i.pan,0);if("number"==typeof c)c=.5*e.clip(c,-1,1)+.5,s.gain.value=Math.cos(c*Math.PI*.5),a.gain.value=Math.sin(c*Math.PI*.5);else{var l=u.createWaveShaper(),f=u.createWaveShaper(),h=t.KVS.get(r+"curve");l.curve=h.L,f.curve=h.R,u.connect(c,l),u.connect(c,f),s.gain.value=0,a.gain.value=0,l.connect(s.gain),f.connect(a.gain)}var p=u.createChannelMerger(2);return s.connect(p,0,0),a.connect(p,0,1),u.connect(o,s),u.connect(o,a),new t.Unit({outlet:p})}var i=t.WS_CURVE_SIZE,r="@neume:pan2:";t.register("pan2",function(t,e,i){return n(t,e,i)}),t.KVS.set(r+"curve",function(){for(var t=new Float32Array(i),e=new Float32Array(i),n=0;i>n;n++)t[n]=Math.cos(n/i*Math.PI*.5),e[n]=Math.sin(n/i*Math.PI*.5);return{L:t,R:e}})}},{}],50:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,i,r){var o=n.context,u=o.createWaveShaper();return e instanceof Float32Array&&(u.curve=e),u.oversample={"2x":"2x","4x":"4x"}[i.oversample]||"none",o.connect(r,u),new t.Unit({outlet:u})}var i=t.WS_CURVE_SIZE,r="@neume:shaper:";t.register("shaper",function(i,o,u){var s=null;if("number"==typeof o.curve){var a=Math.floor(256*e.clip(e.finite(o.curve),0,1));s=t.KVS.get(r+a,a)}else s=o.curve;return n(s,i,o,u)}),t.register("clip",function(e,i,o){var u=t.KVS.get(r+"0");return n(u,e,i,o)}),function(){function e(t){for(var e,n=new Float32Array(i),r=2*t/(1-t),o=0;i>o;o++)e=2*o/i-1,n[o]=(1+r)*e/(1+r*Math.abs(e));return n}function n(t){return function(){return e(t)}}for(var o=1;256>o;o++)t.KVS.set(r+o,n(o/256))}(),t.KVS.set(r+"0",function(){for(var t=new Float32Array(i),e=0;i>e;e++)t[e]=e/i*2-1;return t}),t.KVS.set(r+"256",function(){for(var t=new Float32Array(i),e=i>>1,n=0;i>n;n++)t[n]=e>n?-1:1;return t})}},{}],51:[function(t,e){"use strict";function n(){this._all=[],this._ids={}}n.prototype.append=function(t){return this._all.push(t),t.id&&(this._ids[t.id]=t),this},n.prototype.all=function(){return this._all},n.prototype.find=function(t){var e=null;return e=t.id?this._ids[t.id]?[this._ids[t.id]]:[]:this._all,t.classes&&t.classes.forEach(function(t){e=e.filter(function(e){return-1!==e.classes.indexOf(t)})}),t.key&&(e=e.filter(function(e){return e.key===t.key})),e},e.exports=n},{}],52:[function(t,e){"use strict";function n(){this._callbacks={}}n.prototype.hasListeners=function(t){return this._callbacks.hasOwnProperty(t)},n.prototype.listeners=function(t){return this.hasListeners(t)?this._callbacks[t].slice():[]},n.prototype.on=function(t,e){return"function"==typeof e&&(this.hasListeners(t)||(this._callbacks[t]=[]),this._callbacks[t].push(e)),this},n.prototype.once=function(t,e){if("function"==typeof e){var n=function(i){this.off(t,n),e.call(this,i)};n.listener=e,this.on(t,n)}return this},n.prototype.off=function(t,e){return"undefined"==typeof e?"undefined"==typeof t?this._callbacks={}:this.hasListeners(t)&&delete this._callbacks[t]:this.hasListeners(t)&&(this._callbacks[t]=this._callbacks[t].filter(function(t){return!(t===e||t.listener===e)})),this},n.prototype.emit=function(t,e,n){this.listeners(t).forEach(function(t){t.call(this,e)},n||this)},e.exports=n},{}],53:[function(t,e){"use strict";function n(t){var e,n,i,r,s,a,c,l,f,h,p,d=1<<Math.ceil(Math.log(u.finite(t.length))*Math.LOG2E),m=new Float32Array(d),v=new Float32Array(d),y=new Float32Array(d),x=o(d),_=x.bitrev,g=x.sintable,b=x.costable;for(e=0;d>e;e++)m[e]=t[e],v[e]=t[_[e]],y[e]=0;for(i=1;d>i;i=r)for(s=0,r=i+i,a=d/r,n=0;i>n;n++){for(c=b[s],l=g[s],e=n;d>e;e+=r)f=e+i,h=l*y[f]+c*v[f],p=c*y[f]-l*v[f],v[f]=v[e]-h,y[f]=y[e]-p,v[e]+=h,y[e]+=p;s+=a}return{real:v,imag:y}}function i(t,e){var n,i,r,s,a,c,l,f,h,p,d,m=1<<Math.ceil(Math.log(u.finite(t.length))*Math.LOG2E),v=new Float32Array(m),y=new Float32Array(m),x=new Float32Array(m),_=o(m),g=_.bitrev,b=_.sintable,w=_.costable;for(n=0;m>n;n++)i=g[n],y[n]=+t[i],x[n]=-e[i];for(r=1;m>r;r=s)for(a=0,s=r+r,c=m/s,i=0;r>i;i++){for(l=w[a],f=b[a],n=i;m>n;n+=s)h=n+r,p=f*x[h]+l*y[h],d=l*x[h]-f*y[h],y[h]=y[n]-p,x[h]=x[n]-d,y[n]+=p,x[n]+=d;a+=c}for(n=0;m>n;n++)v[n]=y[n]/m;return v}function r(t){for(var e=new Int16Array(t),n=t>>1,i=0,r=0;;){if(e[i]=r,++i>=t)break;for(var o=n;r>=o;)r-=o,o>>=1;r+=o}return e}function o(t){if(o.cache[t])return o.cache[t];for(var e=r(t),n=Math.floor(Math.log(t)/Math.LN2),i=new Float32Array((1<<n)-1),u=new Float32Array((1<<n)-1),s=0,a=i.length;a>s;s++)i[s]=Math.sin(2*Math.PI*(s/t)),u[s]=Math.cos(2*Math.PI*(s/t));return o.cache[t]={bitrev:e,sintable:i,costable:u},o.cache[t]}var u=t("../util");o.cache=[],e.exports={forward:n,inverse:i}},{"../util":54}],54:[function(t,e){"use strict";var n={};n.isPlainObject=function(t){return null!=t&&t.constructor===Object},n.isFinite=function(t){return"number"==typeof t&&isFinite(t)},n.isIterator=function(t){return!!t&&"function"==typeof t.next},n.toArray=function(t){return null==t?[]:Array.prototype.slice.call(t)},n.flatten=function(t){return Array.isArray(t)?t.reduce(function(t,e){return t.concat(Array.isArray(e)?n.flatten(e):e)},[]):[t]},n.definePropertyIfNotExists=function(t,e,n){return t.hasOwnProperty(e)||Object.defineProperty(t,e,n),t},n.format=function(t,e){return Object.keys(e).forEach(function(n){/^\w+$/.test(n)&&(t=t.replace(new RegExp("#\\{"+n+"\\}","g"),e[n]))}),t},n.num=function(t){return+t||0},n.int=function(t){return 0|+t},n.finite=function(t){return t=+t||0,n.isFinite(t)||(t=0),t},n.clip=function(t,e,n){return Math.max(e,Math.min(t,n))},n.typeOf=function(t){var e=typeof t;if("number"===e)return t===t?"number":"nan";if("string"===e)return"string";if("function"===e)return"function";if("boolean"===e)return"boolean";if(null===t)return"null";if(void 0===t)return"undefined";
if(Array.isArray(t))return"array";var n;return t.constructor&&("string"==typeof t.constructor.$$name?n=t.constructor.$$name:t.constructor.name&&"string"==typeof t.constructor.name&&(n=t.constructor.name)),n||(n=Object.prototype.toString.call(t).slice(8,-1)),"Object"===n&&(n="object"),n},n.defaults=function(){var t,e,i=n.toArray(arguments);for(t=0,e=i.length;e>t;t++)if(null!=i[t])return i[t];return null},n.inherits=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},e.exports=n},{}],55:[function(t,e){"use strict";var n=t("../util"),i={},r={};e.exports={exists:function(t){return t=String(t),r.hasOwnProperty(t)},set:function(t,e){t=String(t),r.hasOwnProperty(t)&&delete i[t],r[t]=e},get:function(t){if(t=String(t),!i.hasOwnProperty(t)){if(!r.hasOwnProperty(t))throw new Error("key '"+t+"' is not registered.");i[t]="@"===t.charAt(0)&&"function"==typeof r[t]?r[t].apply(null,n.toArray(arguments).slice(1)):r[t],r[t]=null}return i[t]}}},{"../util":54}],56:[function(t,e){"use strict";var n=t("./"),i={};i.exports=function(){return Object.create(i)},i.asInt=n.int,i.midicps=function(t){return 440*Math.pow(2,(t-69)/12)},i.mtof=i.midicps,i.cpsmidi=function(t){return Math.log(t/440)*Math.LOG2E*12+69},i.ftom=i.cpsmidi,i.midiratio=function(t){return Math.pow(2,t/12)},i.ratiomidi=function(t){return Math.log(Math.abs(t))*Math.LOG2E*12},i.dbamp=function(t){return Math.pow(10,.05*t)},i.ampdb=function(t){return Math.log(t)*Math.LOG10E*20},i.linlin=function(t,e,n,i,r){return(t-e)/(n-e)*(r-i)+i},i.linexp=function(t,e,n,i,r){return Math.pow(r/i,(t-e)/(n-e))*i},i.explin=function(t,e,n,i,r){return Math.log(t/e)/Math.log(n/e)*(r-i)+i},i.expexp=function(t,e,n,i,r){return Math.pow(r/i,Math.log(t/e)/Math.log(n/e))*i},i.coin=function(t,e){return t=n.finite(n.defaults(t,.5)),e=n.defaults(e,Math.random),e()<t},i.rand=function(t,e){return t=n.finite(n.defaults(t,1)),e=n.defaults(e,Math.random),e()*t},i.rand2=function(t,e){return t=n.finite(n.defaults(t,1)),e=n.defaults(e,Math.random),(2*e()-1)*t},i.rrand=function(t,e,r){return t=n.finite(n.defaults(t,0)),e=n.finite(n.defaults(e,1)),r=n.defaults(r,Math.random),i.linlin(r(),0,1,t,e)},i.exprand=function(t,e,r){return t=n.finite(n.defaults(t,1e-6)),e=n.finite(n.defaults(e,1)),r=n.defaults(r,Math.random),i.linexp(r(),0,1,t,e)},i.at=function(t,e){return t[0|e]},i.clipAt=function(t,e){return t[Math.max(0,Math.min(0|e,t.length-1))]},i.wrapAt=function(t,e){return e=0|e,e%=t.length,0>e&&(e+=t.length),t[e]},i.foldAt=function(t,e){e=0|e;var n=2*t.length-2;return e%=n,0>e&&(e+=n),t.length<=e&&(e=n-e),t[e]},e.exports=i},{"./":54}]},{},[1]);
//# sourceMappingURL=neume.min.js.map